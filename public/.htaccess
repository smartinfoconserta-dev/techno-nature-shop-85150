# ==========================================
# RAMON TECH - Configura√ß√£o para Hostinger
# ==========================================

# MIME Types - CR√çTICO para evitar erro 406
AddType application/javascript .js .mjs
AddType text/css .css
AddType application/json .json
AddDefaultCharset UTF-8

# Desabilitar mod_security completamente
<IfModule mod_security.c>
  SecFilterEngine Off
  SecFilterScanPOST Off
  SecFilterCheckURLEncoding Off
  SecFilterCheckCookieFormat Off
</IfModule>

# Permitir todos os m√©todos HTTP
<IfModule mod_headers.c>
  Header always set Access-Control-Allow-Methods "GET, POST, PUT, DELETE, OPTIONS, PATCH"
  Header always set Access-Control-Allow-Headers "Content-Type, Authorization, X-Requested-With, Accept, apikey, x-client-info"
  
  # Anti-cache AGRESSIVO para HTML e Service Workers
  <FilesMatch "\.(html)$">
    Header always set Cache-Control "no-store, no-cache, must-revalidate, max-age=0"
    Header always set Pragma "no-cache"
    Header always set Expires "0"
  </FilesMatch>
  
  # Bloquear cache de qualquer arquivo de service worker
  <FilesMatch "(service-worker|sw|workbox.*)\.(js|json)$">
    Header always set Cache-Control "no-store, no-cache, must-revalidate, max-age=0"
    Header always set Pragma "no-cache"
    Header always set Expires "0"
  </FilesMatch>
</IfModule>

# Desabilitar cache do LiteSpeed
<IfModule LiteSpeed>
  CacheDisable public /
  CacheDisable private /
</IfModule>

# üîí For√ßar HTTPS e redirecionar www ‚Üí n√£o-www
<IfModule mod_rewrite.c>
  RewriteEngine On
  RewriteCond %{HTTPS} off [OR]
  RewriteCond %{HTTP_HOST} ^www\.ramontech\.com\.br$ [NC]
  RewriteRule ^(.*)$ https://ramontech.com.br/$1 [L,R=301]
</IfModule>

# Headers de Seguran√ßa
<IfModule mod_headers.c>
  Header set X-Content-Type-Options "nosniff"
  Header set X-Frame-Options "SAMEORIGIN"
  Header set X-XSS-Protection "1; mode=block"
  Header set Referrer-Policy "strict-origin-when-cross-origin"
  Header always set Strict-Transport-Security "max-age=31536000; includeSubDomains; preload"
</IfModule>

# Compress√£o GZIP
<IfModule mod_deflate.c>
  AddOutputFilterByType DEFLATE text/html text/plain text/css text/javascript application/javascript application/json
</IfModule>

# Cache para Assets
<IfModule mod_expires.c>
  ExpiresActive On
  ExpiresByType image/jpg "access plus 1 year"
  ExpiresByType image/jpeg "access plus 1 year"
  ExpiresByType image/png "access plus 1 year"
  ExpiresByType image/webp "access plus 1 year"
  ExpiresByType image/svg+xml "access plus 1 year"
  ExpiresByType text/css "access plus 1 month"
  ExpiresByType application/javascript "access plus 1 month"
  ExpiresByType text/html "access plus 0 seconds"
</IfModule>

# React Router - SPA Support + Canonical redirect and reset-cache route
<IfModule mod_rewrite.c>
  RewriteEngine On
  RewriteBase /

  # Rota reset-cache tem prioridade antes dos outros rewrites

  # Serve reset-cache static HTML (bypass SPA rewrite)
  RewriteRule ^reset-cache$ /reset-cache.html [L]

  # Allow direct index.html
  RewriteRule ^index\.html$ - [L]

  # SPA fallback
  RewriteCond %{REQUEST_FILENAME} !-f
  RewriteCond %{REQUEST_FILENAME} !-d
  RewriteCond %{REQUEST_FILENAME} !-l
  RewriteRule . /index.html [L]
</IfModule>
# Prote√ß√£o de Arquivos Sens√≠veis
<FilesMatch "^\.">
  Order allow,deny
  Deny from all
</FilesMatch>

# Desabilitar listagem de diret√≥rios
Options -Indexes
